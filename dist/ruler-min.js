!function(t,i){"function"==typeof define&&(define.amd||define.cmd)?define(i):t.Ruler=i()}(this,function(){"use strict";var t=function(i){this.container=null,this.canvas=null,this.ctx=null,this.value=0,this.score=0,this.translateX=0;var e={container:null,showWrap:null,unit:1,min:0,max:100,prefill:0,lineWidth:1,stepWidth:6,height:50,minNode:8,midNode:15,maxNode:20,basicColor:"#E4E4E4",checkedColor:"#f00",textColor:"#f00",moveCallback:function(){},endCallback:function(){}},s=window.devicePixelRatio;Object.assign(e,i),this.init=function(){this.container=document.querySelector(e.container),this.showWrap=document.querySelector(e.showWrap),this.width=e.width?e.width:t.getStyle(this.container,"width"),this.container.style.width=this.width+"px",this.container.style.WebkitTransform="translateZ(0)",this.container.style.overflow="hidden",this.range=(e.max-e.min)/e.unit;var i=document.createElement("canvas");i.width=this.calc(this.range*e.stepWidth+this.width),i.height=this.calc(e.height),i.style.width=this.range*e.stepWidth+this.width+"px",i.style.height=e.height+"px",this.canvas=i,this.ctx=i.getContext("2d"),this.conversion(e.prefill,!1),this.translateX=-this.score*e.stepWidth,this.canvas.style.WebkitTransform="matrix(1, 0, 0, 1, "+this.translateX+", 0)",this.assignment(),this.draw(this.score),this.addEvent(),this.container.appendChild(i)},this.calc=function(t){return t*s},this.conversion=function(t,i){i?(this.score=Math.floor(Math.abs(t)/e.stepWidth),this.value=this.score*e.unit+e.min):(this.value=Math.floor(t/e.unit)*e.unit,this.score=(this.value-e.min)/e.unit)},this.assignment=function(){this.showWrap.innerText=this.value},this.draw=function(t){var i,n=0,a=0;for(this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),i=0;i<=this.range;i++)this.ctx.save(),this.ctx.lineWidth=e.lineWidth,this.ctx.strokeStyle=e.basicColor,this.ctx.scale(s,s),this.ctx.translate(this.width/2+e.stepWidth*i,e.height),this.ctx.beginPath(),this.ctx.moveTo(0,0),i%5==0?i%2==0?this.ctx.lineTo(0,-e.maxNode):this.ctx.lineTo(0,-e.midNode):this.ctx.lineTo(0,-e.minNode),this.ctx.closePath(),this.ctx.stroke(),this.ctx.restore();for(i=0;i<=this.range;i++){if(this.ctx.save(),this.ctx.font="10px",this.ctx.fillStyle=e.basicColor,this.ctx.scale(s,s),i%10==0){let t=e.min+n*e.unit*10;this.ctx.translate(-this.ctx.measureText(t).width/2,0),this.ctx.fillText(t,this.width/2+n*e.stepWidth*10,e.maxNode+2),n++}this.ctx.restore()}for(i=0;i<=t;i++)this.ctx.save(),this.ctx.lineWidth=e.lineWidth,this.ctx.strokeStyle=e.checkedColor,this.ctx.scale(s,s),this.ctx.translate(this.width/2+e.stepWidth*i,e.height),this.ctx.beginPath(),this.ctx.moveTo(0,0),i%5==0?i%2==0?this.ctx.lineTo(0,-e.maxNode):this.ctx.lineTo(0,-e.midNode):this.ctx.lineTo(0,-e.minNode),this.ctx.closePath(),this.ctx.stroke(),this.ctx.restore();for(i=0;i<=t;i++){if(this.ctx.save(),this.ctx.font="10px",this.ctx.fillStyle=e.textColor,this.ctx.scale(s,s),i%10==0){let t=e.min+a*e.unit*10;this.ctx.translate(-this.ctx.measureText(t).width/2,0),this.ctx.fillText(t,this.width/2+a*e.stepWidth*10,e.maxNode+2),a++}this.ctx.restore()}},this.addEvent=function(){function t(t){var i=t.touches[0].pageX-n,a=c.translateX=h+i;c.translateX<=0&&c.translateX>=-(c.canvas.width/s-c.width+1)?(c.conversion(c.translateX,!0),c.draw(c.score)):c.translateX>=0?(c.conversion(0,!0),c.draw(0)):(c.conversion(c.range*e.stepWidth,!0),c.draw(c.range)),c.assignment(),c.canvas.style.WebkitTransform="matrix(1, 0, 0, 1, "+a+", 0)",e.moveCallback(c)}function i(n){c.canvas.style.transition="transform 0.2s",c.translateX>=0?c.translateX=0:c.translateX<-(c.canvas.width/s-c.width)?c.translateX=-(c.canvas.width/s-c.width):c.translateX=-Math.floor(-c.translateX/e.stepWidth)*e.stepWidth,c.conversion(c.translateX,!0),c.assignment(),c.draw(c.score),c.canvas.style.WebkitTransform="matrix(1, 0, 0, 1, "+c.translateX+", 0)",e.endCallback(c),setTimeout(function(){c.canvas.style.transition=""},100),document.removeEventListener("touchmove",t),document.removeEventListener("touchend",i)}var n,a,h,c=this;c.container.addEventListener("touchstart",function(e){e.preventDefault(),n=e.touches[0].pageX,a=c.canvas.style.WebkitTransform,h=parseInt(a.substring(7).split(",")[4]),document.addEventListener("touchmove",t),document.addEventListener("touchend",i)})},this.init()};return t.getStyle=function(t,i){return t.currentStyle?parseInt(t.currentStyle[i]):parseInt(getComputedStyle(t,!1)[i])},t});