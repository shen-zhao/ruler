!function(t,i){"function"==typeof define&&(define.amd||define.cmd)?define(i):t.Ruler=i()}(this,function(){"use strict";var t=function(i){this.container=null,this.canvas=null,this.ctx=null,this.value=0,this.score=0,this.translateX=0;var e={container:null,showWrap:null,unit:1,min:0,max:100,prefill:0,lineWidth:1,stepWidth:6,height:50,minNode:8,midNode:15,maxNode:20,basicColor:"#E4E4E4",checkedColor:"#f00",textColor:"#f00",moveCallback:function(){},endCallback:function(){}};Object.assign(e,i),this.init=function(){this.container=document.querySelector(e.container),this.showWrap=document.querySelector(e.showWrap),this.width=this.calcWidth(),this.container.style.width=this.width+"px",this.container.style.WebkitTransform="translateZ(0)",this.container.style.overflow="hidden",this.range=(e.max-e.min)/e.unit;var t=document.createElement("canvas");t.width=this.range*e.stepWidth+this.width,t.height=e.height,this.canvas=t,this.ctx=t.getContext("2d"),this.conversion(e.prefill,!1),this.translateX=-this.score*e.stepWidth,this.canvas.style.WebkitTransform="matrix(1, 0, 0, 1, "+this.translateX+", 0)",this.assignment(),this.draw(this.score),this.addEvent(),this.container.appendChild(t)},this.calcWidth=function(){var i=e.width?e.width:t.getStyle(this.container,"width");return e.lineWidth%2?2*parseInt(i/2):2*parseInt(i/2)+1},this.conversion=function(t,i){i?(this.score=Math.floor(Math.abs(t)/e.stepWidth),this.value=this.score*e.unit+e.min):(this.value=Math.floor(t/e.unit)*e.unit,this.score=(this.value-e.min)/e.unit)},this.assignment=function(){this.showWrap.innerText=this.value},this.draw=function(t){var i,s=0,n=0;for(this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),i=0;i<=this.range;i++)this.ctx.save(),this.ctx.lineWidth=e.lineWidth,this.ctx.strokeStyle=e.basicColor,this.ctx.translate(this.width/2+e.stepWidth*i,e.height),this.ctx.beginPath(),this.ctx.moveTo(0,0),i%5==0?i%2==0?this.ctx.lineTo(0,-e.maxNode):this.ctx.lineTo(0,-e.midNode):this.ctx.lineTo(0,-e.minNode),this.ctx.closePath(),this.ctx.stroke(),this.ctx.restore();for(i=0;i<=this.range;i++){if(this.ctx.save(),this.ctx.font="10px Arial",this.ctx.fillStyle=e.basicColor,i%10==0){let t=e.min+s*e.unit*10;this.ctx.translate(-this.ctx.measureText(t).width/2,0),this.ctx.fillText(t,this.width/2+s*e.stepWidth*10,e.maxNode+2),s++}this.ctx.restore()}for(i=0;i<=t;i++)this.ctx.save(),this.ctx.lineWidth=e.lineWidth,this.ctx.strokeStyle=e.checkedColor,this.ctx.translate(this.width/2+e.stepWidth*i,e.height),this.ctx.beginPath(),this.ctx.moveTo(0,0),i%5==0?i%2==0?this.ctx.lineTo(0,-e.maxNode):this.ctx.lineTo(0,-e.midNode):this.ctx.lineTo(0,-e.minNode),this.ctx.closePath(),this.ctx.stroke(),this.ctx.restore();for(i=0;i<=t;i++){if(this.ctx.save(),this.ctx.font="10px Arial",this.ctx.fillStyle=e.textColor,i%10==0){let t=e.min+n*e.unit*10;this.ctx.translate(-this.ctx.measureText(t).width/2,0),this.ctx.fillText(t,this.width/2+n*e.stepWidth*10,e.maxNode+2),n++}this.ctx.restore()}},this.addEvent=function(){function t(t){var i=t.touches[0].pageX-s,n=h.translateX=a+i;h.translateX<=0&&h.translateX>=-(h.canvas.width-h.width+1)?(h.conversion(h.translateX,!0),h.draw(h.score)):h.translateX>=0?(h.conversion(0,!0),h.draw(0)):(h.conversion(h.range,!0),h.draw(h.range)),h.assignment(),h.canvas.style.WebkitTransform="matrix(1, 0, 0, 1, "+n+", 0)",e.moveCallback(h)}function i(s){h.canvas.style.transition="transform 0.2s",h.translateX>=0?h.translateX=0:h.translateX<-(h.canvas.width-h.width)?h.translateX=-(h.canvas.width-h.width):h.translateX=-Math.floor(-h.translateX/e.stepWidth)*e.stepWidth,h.conversion(h.translateX,!0),h.assignment(),h.draw(h.score),h.canvas.style.WebkitTransform="matrix(1, 0, 0, 1, "+h.translateX+", 0)",e.endCallback(h),setTimeout(function(){h.canvas.style.transition=""},100),document.removeEventListener("touchmove",t),document.removeEventListener("touchend",i)}var s,n,a,h=this;h.container.addEventListener("touchstart",function(e){e.preventDefault(),s=e.touches[0].pageX,n=h.canvas.style.WebkitTransform,a=parseInt(n.substring(7).split(",")[4]),document.addEventListener("touchmove",t),document.addEventListener("touchend",i)})},this.init()};return t.getStyle=function(t,i){return t.currentStyle?parseInt(t.currentStyle[i]):parseInt(getComputedStyle(t,!1)[i])},t});