!function(t,e){"function"==typeof define&&(define.amd||define.cmd)?define(e):t.Ruler=e()}(this,function(){"use strict";var t=function(e){this.container=null,this.canvas=null,this.ctx=null,this.value=0,this.score=0,this.translateX=0;var i={container:null,showWrap:null,unit:1,min:0,max:100,prefill:0,lineWidth:1,stepWidth:6,height:50,minNode:8,midNode:15,maxNode:20,basicColor:"#E4E4E4",checkedColor:"#f00",textColor:"#f00",moveCallback:function(){},endCallback:function(){}},s=window.devicePixelRatio;Object.assign(i,e),this.init=function(){this.container=document.querySelector(i.container),this.showWrap=document.querySelector(i.showWrap),this.width=i.width?i.width:t.getStyle(this.container,"width"),this.container.style.width=this.width+"px",this.container.style.WebkitTransform="translateZ(0)",this.container.style.overflow="hidden",this.range=(i.max-i.min)/i.unit;var e=document.createElement("canvas");e.width=this.calc(this.range*i.stepWidth+this.width),e.height=this.calc(i.height),e.style.width=this.range*i.stepWidth+this.width+"px",e.style.height=i.height+"px",this.canvas=e,this.ctx=e.getContext("2d"),this.conversion(i.prefill,!1),this.translateX=-this.score*i.stepWidth,this.canvas.style.WebkitTransform="matrix(1, 0, 0, 1, "+this.translateX+", 0)",this.assignment(),this.draw(this.score),this.addEvent(),this.container.appendChild(e)},this.calc=function(t){return t*s},this.conversion=function(t,e){e?(this.score=Math.floor(Math.abs(t)/i.stepWidth),this.value=this.score*i.unit+i.min):(this.value=Math.floor(t/i.unit)*i.unit,this.score=(this.value-i.min)/i.unit)},this.assignment=function(){this.showWrap.innerText=this.value},this.draw=function(t){var e,n=0,a=0;for(this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),e=0;e<=this.range;e++)this.ctx.save(),this.ctx.lineWidth=i.lineWidth,this.ctx.strokeStyle=i.basicColor,this.ctx.scale(s,s),this.ctx.translate(this.width/2+i.stepWidth*e,i.height),this.ctx.beginPath(),this.ctx.moveTo(0,0),e%5==0?e%2==0?this.ctx.lineTo(0,-i.maxNode):this.ctx.lineTo(0,-i.midNode):this.ctx.lineTo(0,-i.minNode),this.ctx.closePath(),this.ctx.stroke(),this.ctx.restore();for(e=0;e<=this.range;e++){if(this.ctx.save(),this.ctx.font="10px",this.ctx.fillStyle=i.basicColor,this.ctx.scale(s,s),e%10==0){let t=i.min+n*i.unit*10;this.ctx.translate(-this.ctx.measureText(t).width/2,0),this.ctx.fillText(t,this.width/2+n*i.stepWidth*10,i.maxNode+2),n++}this.ctx.restore()}for(e=0;e<=t;e++)this.ctx.save(),this.ctx.lineWidth=i.lineWidth,this.ctx.strokeStyle=i.checkedColor,this.ctx.scale(s,s),this.ctx.translate(this.width/2+i.stepWidth*e,i.height),this.ctx.beginPath(),this.ctx.moveTo(0,0),e%5==0?e%2==0?this.ctx.lineTo(0,-i.maxNode):this.ctx.lineTo(0,-i.midNode):this.ctx.lineTo(0,-i.minNode),this.ctx.closePath(),this.ctx.stroke(),this.ctx.restore();for(e=0;e<=t;e++){if(this.ctx.save(),this.ctx.font="10px",this.ctx.fillStyle=i.textColor,this.ctx.scale(s,s),e%10==0){let t=i.min+a*i.unit*10;this.ctx.translate(-this.ctx.measureText(t).width/2,0),this.ctx.fillText(t,this.width/2+a*i.stepWidth*10,i.maxNode+2),a++}this.ctx.restore()}},this.addEvent=function(){function t(t){var e=t.touches[0].pageX-s,n=h.translateX=a+e;h.translateX<=0&&h.translateX>=-(h.range*i.stepWidth+1)?(h.conversion(h.translateX,!0),h.draw(h.score)):h.translateX>=0?(h.conversion(0,!0),h.draw(0)):(h.conversion(h.range*i.stepWidth,!0),h.draw(h.range)),h.assignment(),h.canvas.style.WebkitTransform="matrix(1, 0, 0, 1, "+n+", 0)",i.moveCallback(h)}function e(s){h.canvas.style.transition="transform 0.2s",h.translateX>=0?h.translateX=0:h.translateX<-h.range*i.stepWidth?h.translateX=-h.range*i.stepWidth:h.translateX=-Math.floor(-h.translateX/i.stepWidth)*i.stepWidth,h.conversion(h.translateX,!0),h.assignment(),h.draw(h.score),h.canvas.style.WebkitTransform="matrix(1, 0, 0, 1, "+h.translateX+", 0)",i.endCallback(h),setTimeout(function(){h.canvas.style.transition=""},100),document.removeEventListener("touchmove",t),document.removeEventListener("touchend",e)}var s,n,a,h=this;h.container.addEventListener("touchstart",function(i){i.preventDefault(),s=i.touches[0].pageX,n=h.canvas.style.WebkitTransform,a=parseInt(n.substring(7).split(",")[4]),document.addEventListener("touchmove",t),document.addEventListener("touchend",e)})},this.init()};return t.getStyle=function(t,e){return t.currentStyle?parseInt(t.currentStyle[e]):parseInt(getComputedStyle(t,!1)[e])},t});